# Default values for databasement
# This is a YAML-formatted file.

replicaCount: 1

image:
  repository: davidcrty/databasement
  pullPolicy: Always
  tag: "latest"

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

deploymentStrategy: ""

# Application configuration
app:
  name: Databasement
  env: production
  debug: false
  url: http://localhost:8000
  # Application encryption key (required)
  # Generate with: docker run --rm davidcrty/databasement:latest php artisan key:generate --show
  key: ""
  # Use existing secret for app key
  existingSecret: ""
  secretKeys:
    appKey: APP_KEY

# Worker configuration
worker:
  enabled: true
  # Deploy worker as separate deployment (requires ReadWriteMany storage or external database)
  # When false, worker runs as sidecar container in the same pod as the app
  separateDeployment: false
  replicaCount: 1
  command: "php artisan queue:work --queue=backups,default --tries=3 --timeout=3600 --sleep=3 --max-jobs=1000"
  resources:
    limits:
      cpu: 300m
      memory: 256Mi
    requests:
      cpu: 50m
      memory: 128Mi


# Database configuration
database:
  # Database driver: sqlite, mysql, pgsql
  connection: sqlite
  # For SQLite
  sqlitePath: /data/database.sqlite
  # For MySQL/PostgreSQL
  host: ""
  port: 3306
  name: databasement
  username: databasement
  password: ""
  # Use existing secret for database password
  existingSecret: ""
  secretKeys:
    password: DB_PASSWORD

# Logging
logging:
  channel: stderr
  level: warning

ingress:
  enabled: false
  className: ""
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # cert-manager.io/cluster-issuer: letsencrypt-prod
  host: databasement.local
  tlsSecretName: ""

resources:
  limits:
    cpu: 500m
    memory: 512Mi
  requests:
    cpu: 100m
    memory: 256Mi

# Persistence for storage volume
persistence:
  enabled: true
  storageClass: ""
  accessModes:
    - ReadWriteOnce
  size: 10Gi
  annotations: {}
  path: /data

extraVolumeMounts: {}
extraVolumes: {}

# Liveness and readiness probes
livenessProbe:
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

readinessProbe:
  httpGet:
    path: /health
    port: http
  initialDelaySeconds: 10
  periodSeconds: 5
  timeoutSeconds: 3
  failureThreshold: 3


serviceAccount:
  create: false
  automount: true
  annotations: {}
  name: ""

podAnnotations: {}
podLabels: {}

podSecurityContext:
  fsGroup: 1000

securityContext:
  runAsNonRoot: true
  runAsUser: 1000
  runAsGroup: 1000

service:
  type: ClusterIP
  port: 80
  targetPort: 8000

nodeSelector: {}

tolerations: []

affinity: {}

